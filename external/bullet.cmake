if(NOT DEP_CMAKE_PATH OR NOT DEP_INSTALL_ROOT)
  message(FATAL_ERROR "DEP_CMAKE_PATH and DEP_INSTALL_ROOT must be set before including modules defined within /external")
endif()

########################################################################
# Install BULLET
########################################################################
set(libBullet bullet)
ExternalProject_Add(${libBullet}
PREFIX			${DEP_CMAKE_PATH}/${libBullet}
GIT_REPOSITORY  https://github.com/bulletphysics/bullet3.git
GIT_TAG         3.25
GIT_SHALLOW     ON
UPDATE_COMMAND 	""
CMAKE_ARGS      -DCMAKE_INSTALL_PREFIX:PATH=${DEP_INSTALL_ROOT}/${libBullet}
				-DINSTALL_LIBS:BOOL=ON
				-DBUILD_BULLET2_DEMOS:BOOL=OFF
				-DBUILD_BULLET3:BOOL=OFF
				-DBUILD_CLSOCKET:BOOL=OFF
				-DBUILD_CPU_DEMOS:BOOL=OFF
				-DBUILD_EGL:BOOL=OFF
				-DBUILD_ENET:BOOL=OFF
				-DBUILD_EXTRAS:BOOL=OFF
				-DBUILD_OPENGL3_DEMOS:BOOL=OFF
				-DBUILD_UNIT_TESTS:BOOL=OFF
				-DENABLE_VHACD:BOOL=OFF
				-DINSTALL_CMAKE_FILES:BOOL=OFF
				-DINSTALL_EXTRA_LIBS:BOOL=OFF
				-DUSE_GLUT:BOOL=OFF
				-DUSE_GRAPHICAL_BENCHMARK:BOOL=OFF
)

add_library(BULLET_COLLISION_LIBRARY STATIC IMPORTED)
add_library(BULLET_DYNAMICS_LIBRARY STATIC IMPORTED)
add_library(BULLET_INVERSE_DYNAMICS_LIBRARY STATIC IMPORTED)
add_library(BULLET_SOFT_BODY_LIBRARY STATIC IMPORTED)
add_library(LINEAR_MATH_LIBRARY STATIC IMPORTED)

if(MSVC)
	set_target_properties(
	BULLET_COLLISION_LIBRARY 
	PROPERTIES 
		IMPORTED_LOCATION_RELEASE ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletCollision${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_MINSIZEREL ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletCollision_MinsizeRel${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_RELWITHDEBINFO ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletCollision_RelWithDebugInfo${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_DEBUG ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletCollision_Debug${CMAKE_STATIC_LIBRARY_SUFFIX}
	)
	
	set_target_properties(
	BULLET_DYNAMICS_LIBRARY 
	PROPERTIES 
		IMPORTED_LOCATION_RELEASE ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletDynamics${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_MINSIZEREL ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletDynamics_MinsizeRel${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_RELWITHDEBINFO ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletDynamics_RelWithDebugInfo${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_DEBUG ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletDynamics_Debug${CMAKE_STATIC_LIBRARY_SUFFIX}
	)
	
	set_target_properties(
	BULLET_INVERSE_DYNAMICS_LIBRARY 
	PROPERTIES 
		IMPORTED_LOCATION_RELEASE ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletInverseDynamics${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_MINSIZEREL ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletInverseDynamics_MinsizeRel${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_RELWITHDEBINFO ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletInverseDynamics_RelWithDebugInfo${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_DEBUG ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletInverseDynamics_Debug${CMAKE_STATIC_LIBRARY_SUFFIX}
	)
	
	set_target_properties(
	BULLET_SOFT_BODY_LIBRARY 
	PROPERTIES 
		IMPORTED_LOCATION_RELEASE ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletSoftBody${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_MINSIZEREL ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletSoftBody_MinsizeRel${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_RELWITHDEBINFO ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletSoftBody_RelWithDebugInfo${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_DEBUG ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletSoftBody_Debug${CMAKE_STATIC_LIBRARY_SUFFIX}
	)
	
	set_target_properties(
	LINEAR_MATH_LIBRARY 
	PROPERTIES 
		IMPORTED_LOCATION_RELEASE ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}LinearMath${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_MINSIZEREL ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}LinearMath_MinsizeRel${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_RELWITHDEBINFO ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}LinearMath_RelWithDebugInfo${CMAKE_STATIC_LIBRARY_SUFFIX}
		IMPORTED_LOCATION_DEBUG ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}LinearMath_Debug${CMAKE_STATIC_LIBRARY_SUFFIX}
	)
	
else()

	set_target_properties(BULLET_COLLISION_LIBRARY PROPERTIES IMPORTED_LOCATION ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletCollision${CMAKE_STATIC_LIBRARY_SUFFIX})
	set_target_properties(BULLET_DYNAMICS_LIBRARY PROPERTIES IMPORTED_LOCATION ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletDynamics${CMAKE_STATIC_LIBRARY_SUFFIX})
	set_target_properties(BULLET_INVERSE_DYNAMICS_LIBRARY PROPERTIES IMPORTED_LOCATION ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletInverseDynamics${CMAKE_STATIC_LIBRARY_SUFFIX})
	set_target_properties(BULLET_SOFT_BODY_LIBRARY PROPERTIES IMPORTED_LOCATION ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}BulletSoftBody${CMAKE_STATIC_LIBRARY_SUFFIX})
	set_target_properties(LINEAR_MATH_LIBRARY PROPERTIES IMPORTED_LOCATION ${DEP_INSTALL_ROOT}/${libBullet}/lib/${CMAKE_STATIC_LIBRARY_PREFIX}LinearMath${CMAKE_STATIC_LIBRARY_SUFFIX})
	
endif()

set(BULLET_INCLUDE_DIR ${DEP_INSTALL_ROOT}/${libBullet}/include/bullet)